<div ng-app="app">
 <div ng-controller="jobsCtrl" ng-init="setup()">

<h3>Indeed API</h3>
<div class="row">
<p> <%= @results %> </p>
<% @results.each do |result| %>
<p> Company: <%= result["company"] %> </p>
<p> Job title: <%= result["jobtitle"] %> </p>
<p> Location: <%= result["city"] %>, <%= result["state"] %></p>
<p> jobkey: <%= result["jobkey"] %></p>
<% end %>

<br>


    <div id="modal1" class="modal">
      <div class="modal-content">
        <h4>Quick-Add a job listing</h4>
          <div>
          Company: <input ng-model="inputCompany">
          <br>
          Position: <input ng-model="inputPosition">
          <br>
          Source: <input ng-model="inputSource">
          <br>
          Notes: <input ng-model="inputNotes">
          <br>      
          Status: 
            <div class="input-field col s12">
              <select ng-model="inputStatus">
                <option value="" disabled selected>Select job application status</option>
                <option value="not_yet_applied">not applied</option>
                <option value="applying_to">applying</option>
                <option value="applied_to">applied</option>
                <option value="interview_set_up">interview set up</option>
                <option value="interviewed_with">interviewed</option>
                <option value="job_offered">got job offer</option>
            </select>
            </div>
          </div>
      </div>
      <div class="modal-footer">
        <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat" ng-click="addJob(inputCompany, inputPosition, inputSource, inputNotes, inputStatus)"> Add listing</a>
      </div>
    </div> 

<br>
<br>

<div class="row card-panel orange">
<h4>Jobs I haven't applied to yet: </h4>
  <div class="row card-panel orange lighten-4" ng-repeat="job in notYetAppliedJobs | orderBy: 'updated_at' : true">
    <div class="row">
      <div class="col s2">Company</div>
      <div class="col s5">{{job.company}}</div>
    </div>
    <div class="row">
      <div class="col s2">Position</div>
      <div class="col s5">{{job.position}}</div>
    </div>
    <div class="row">
      <div class="col s2">Status</div>
      <div class="col s5">{{job.status}}</div>   
    </div> 
    <div input-field>
        <select ng-options="status as status for status in statuses" ng-model="updatedStatus[$index]" material-select watch>
        <option value="" disabled selected>Change application status</option>
        </select>
    </div>
    <button ng-click="updateStatus(job, updatedStatus[$index])">Update Status</button>
    <p> <a href="/jobs/{{job.id}}">See listing details </a> </p>
  </div>  
</div>

<div class="row card-panel yellow">
<h4>Jobs I am applying to: </h4>
  <div class="row card-panel yellow lighten-4" ng-repeat="job in applyingJobs | orderBy: 'updated_at' : true">
    <div class="row">
      <div class="col s2">Company</div>
      <div class="col s5">{{job.company}}</div>
    </div>
    <div class="row">
      <div class="col s2">Position</div>
      <div class="col s5">{{job.position}}</div>
    </div>
    <div class="row">
      <div class="col s2">Status</div>
      <div class="col s5">{{job.status}}</div>
    </div> 
    <div input-field>
        <select ng-options="status as status for status in statuses" ng-model="updatedStatus[$index]" material-select watch>
        <option value="" disabled selected>Change application status</option>
        </select>
    </div>
    <button ng-click="updateStatus(job, updatedStatus[$index])">Update Status</button> 
    <p> <a href="/jobs/{{job.id}}">See listing details </a> </p>
  </div>  
</div>


<div class="row card-panel light-green">
<h4>Jobs I applied to: </h4>
  <div class="row card-panel light-green lighten-4" ng-repeat="job in appliedJobs | orderBy: 'updated_at' : true">
    <div class="row">
      <div class="col s2">Company</div>
      <div class="col s5">{{job.company}}</div>
    </div>
    <div class="row">
      <div class="col s2">Position</div>
      <div class="col s5">{{job.position}}</div>
    </div>
    <div class="row">
      <div class="col s2">Status</div>
      <div class="col s5">{{job.status}}</div>
    </div>
    <div input-field>
        <select ng-options="status as status for status in statuses" ng-model="updatedStatus[$index]" material-select watch>
        <option value="" disabled selected>Change application status</option>
        </select>
    </div>
    <button ng-click="updateStatus(job, updatedStatus[$index])">Update Status</button>       
    <p> <a href="/jobs/{{job.id}}">See listing details </a> </p>
  </div>  
</div>

<div class="row card-panel teal">
<h4>Jobs I got an interview with: </h4>
  <div class="row card-panel teal lighten-4" ng-repeat="job in interviewSetupJobs | orderBy: 'updated_at' : true">
    <div class="row">
      <div class="col s2">Company</div>
      <div class="col s5">{{job.company}}</div>
    </div>
    <div class="row">
      <div class="col s2">Position</div>
      <div class="col s5">{{job.position}}</div>
    </div>
    <div class="row">
      <div class="col s2">Status</div>
      <div class="col s5">{{job.status}}</div>
    </div>
    <div input-field>
        <select ng-options="status as status for status in statuses" ng-model="updatedStatus[$index]" material-select watch>
        <option value="" disabled selected>Change application status</option>
        </select>
    </div>
    <button ng-click="updateStatus(job, updatedStatus[$index])">Update Status</button>
    <p> <a href="/jobs/{{job.id}}">See listing details </a> </p>
  </div>  
</div>


<div class="row card-panel indigo">
<h4>Jobs I interviewed with: </h4>
  <div class="row card-panel indigo lighten-4" ng-repeat="job in interviewedJobs | orderBy: 'updated_at' : true">
    <div class="row">
      <div class="col s2">Company</div>
      <div class="col s5">{{job.company}}</div>
    </div>
    <div class="row">
      <div class="col s2">Position</div>
      <div class="col s5">{{job.position}}</div>
    </div>
    <div class="row">
      <div class="col s2">Status</div>
      <div class="col s5">{{job.status}}</div>
    </div>
    <div input-field>
        <select ng-options="status as status for status in statuses" ng-model="updatedStatus[$index]" material-select watch>
        <option value="" disabled selected>Change application status</option>
        </select>
    </div>
    <button ng-click="updateStatus(job, updatedStatus[$index])">Update Status</button>
    <p> <a href="/jobs/{{job.id}}">See listing details </a> </p>
  </div>  
</div>

<div class="row card-panel deep-purple">
<h4>Jobs I've received offers from: </h4>
  <div class="row card-panel deep-purple lighten-4" ng-repeat="job in offeredJobs | orderBy: 'updated_at' : true">
    <div class="row">
      <div class="col s2">Company</div>
      <div class="col s5">{{job.company}}</div>
    </div>
    <div class="row">
      <div class="col s2">Position</div>
      <div class="col s5">{{job.position}}</div>
    </div>
    <div class="row">
      <div class="col s2">Status</div>
      <div class="col s5">{{job.status}}</div>
    </div> 
    <div input-field>
        <select ng-options="status as status for status in statuses" ng-model="updatedStatus[$index]" material-select watch>
        <option value="" disabled selected>Change application status</option>
        </select>
    </div>
    <button ng-click="updateStatus(job, updatedStatus[$index])">Update Status</button> 
    <p> <a href="/jobs/{{job.id}}">See listing details </a> </p>
  </div>  
</div>
</div>
</div>


<script>  
  $(document).ready(function() {
    $('select').material_select();
  });

  $(document).ready(function(){
    // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
    $('.modal-trigger').leanModal();
  });
</script>



